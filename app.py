# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/14SOeHwOjbwZjKg-UBwPq4Puha0uaWPTT
"""

pip install transformers

pip install streamlit

import pandas as pd
from transformers import TFBertForSequenceClassification
import tensorflow as tf
from transformers import AutoTokenizer, BertTokenizer, AutoModelForSequenceClassification, BertForSequenceClassification
import transformers
import numpy as np
import streamlit as st

from google.colab import drive
drive.mount('/content/drive')

PRETRAINED_MODEL_NAME = 'neuralmind/bert-base-portuguese-cased'
MAX_SEQUENCE_LENGTH = 512
path = '/content/drive/MyDrive/Mestrado/Orientacao4/4-Modelagem/model/fit/20230824-034806/model.keras'
tokenizer = transformers.BertTokenizer.from_pretrained(PRETRAINED_MODEL_NAME)
model = tf.keras.models.load_model(path, custom_objects={'TFBertForSequenceClassification': TFBertForSequenceClassification})

def batch_encode(X, tokenizer):
    return tokenizer.encode_plus(
    X,
    padding="max_length",
    truncation=True,
    max_length=MAX_SEQUENCE_LENGTH,
    return_attention_mask = True,
    return_token_type_ids=False,
    return_tensors='tf'
)

def predicao(txt):
  txt_tokenized = batch_encode(txt,tokenizer)
  pred = model.predict([txt_tokenized.input_ids, txt_tokenized.attention_mask])
  predictions = np.where(pred <= 0.5, 0, 1)
  return predictions

txt = 'Sofri um de pix e fiz a contestação na mesma hora e a atendente me abriu o MED e disse caso não consiga por aqui vamos tentar outra alternativa, isso dia 16/05/23, dia 17/05/23 hoje já veio indeferido então entrei em contato com o banco e simplesmente me disseram que não tinha o que fazer que eu tinha que entrar em contado com o banco Itaú, pois o pix dos [Editado pelo Reclame Aqui] era de lá, liguei lá e me disseram que ou tinha que falar com Banco do Brasil.Retornei para o Banco do Brasil e disseram que não poderiam fazer nada.Lembrando que a chave pix e a conta dos [Editado pelo Reclame Aqui] estão ativas ainda.Foram 1150,00, que nem meu era.Como confiar assim?Em menos de 24horas já resolveram que não tem o que fazer.,Olá, Samantha!Agradeço o seu registro e espero que esteja tudo bem com você!Lamento pela situação relatada, o nosso objetivo é sempre a plena satisfação dos nossos clientes. Com relação à sua contestação, fiz tudo o que estava ao meu alcance no intuito de atender ao seu pedido. No entanto, após análise da situação, não foram identificadas fragilidades por parte do Banco nas transações questionadas, sendo a contestação indeferida após análise.Explico que as ações adotadas pelo Banco do Brasil seguem o definido em normativos e na Comissão de Prevenção a [Editado pelo Reclame Aqui]s da FEBRABAN.O Banco do Brasil deu o devido tratamento à sua solicitação, no entanto, não foi possível recuperar os valores questionados.Todo esse procedimento é automatizado e segue os critérios e prazos determinados pela legislação vigente.O Banco do Brasil possui rotinas internas para analisar contas recebedoras de créditos contestados, respeitando a legislação vigente e o sigilo bancário das partes.Como estamos em um ambiente público, não é possível que eu forneça mais detalhes por esse canal devido ao sigilo bancário. Infelizmente, você foi vítima de [Editado pelo Reclame Aqui], trata-se de um problema de segurança pública, ocorrido em ambiente externo ao banco e que deve ser conduzido pelas autoridades policiais competentes. Não há evidências de falha de segurança, processos, sistemas ou funcionários do BB.Saliento também que aqui no BB temos uma política de segurança bem definida, investimos em tecnologias e adotamos medidas preventivas e necessárias para preservar a integridade, a confiabilidade, a segurança e o sigilo das transações realizadas, assim como a legitimidade dos serviços prestados.Para dicas de segurança: bb.com.br/segurancaAgradeço por você ter me dado a oportunidade de te atender por esse canal.Se precisar de algo mais ou se tiver qualquer outra dúvida, volte a falar conosco por qualquer um dos nossos canais de atendimento: www.bb.com.br/atendimento.aBBraços!Felipe do BB.'

predicao(txt)

def main():
  st.title('Classificação reclamação')
  text = st.text_input('Digite os itens separados por vírgulas (Ex: Arroz, Feijão, Açúcar) :')
  if text is not '':
    result = predicao(txt)
    st.subheader('**Dados Classificados**')
    st.subheader(result)
    dados = 'ok'

if __name__ == '__main__':
    main()
